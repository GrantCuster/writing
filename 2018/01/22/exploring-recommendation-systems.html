<!DOCTYPE html><html><head><link rel="preload" href="/static/fonts/Inter-Regular.woff2?v=3.5" as="font" type="font/woff2" crossorigin="*"/><link rel="preload" href="/static/fonts/Inter-Italic.woff2?v=3.5" as="font" type="font/woff2" crossorigin="*"/><link href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" rel="stylesheet"/><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" class="next-head"/><meta charSet="utf-8" class="next-head"/><style class="next-head">.js-no-flash { display: none }</style><noscript class="jsx-4059783939 jsx-3344216300 next-head"><style>.js-no-flash { display: block }</style></noscript><link rel="icon" type="image/x-icon" href="static/images/favicon.png" class="jsx-1135431938 jsx-2959859206 next-head"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous" class="jsx-1135431938 jsx-2959859206 next-head"/><title class="jsx-1135431938 jsx-2959859206 next-head">Exploring Recommendation Systems - Cloudera Fast Forward</title><link rel="preload" href="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/posts/2018-01-22-exploring-recommendation-systems.js" as="script"/><link rel="preload" href="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-fdce77a122c11e06ae50.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.f77b50de979bfbbb280b.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-5ab107747766f1b4e0bf.js" as="script"/><style id="__jsx-4059783939">@font-face{font-family:'Inter';font-style:normal;font-weight:400;src:url('/static/fonts/Inter-Regular.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-Regular.woff?v=3.5') format('woff');}@font-face{font-family:'Inter';font-style:italic;font-weight:400;src:url('/static/fonts/Inter-Italic.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-Italic.woff?v=3.5') format('woff');}@font-face{font-family:'Inter';font-style:normal;font-weight:700;src:url('/static/fonts/Inter-Bold.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-Bold.woff?v=3.5') format('woff');}@font-face{font-family:'Inter';font-style:italic;font-weight:700;src:url('/static/fonts/Inter-BoldItalic.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-BoldItalic.woff?v=3.5') format('woff');}*{box-sizing:border-box;}html{font-family:'Inter',serif;font-size:18px;line-height:27px;text-rendering:optimizelegibility;font-feature-settings:'kern';font-kerning:normal;font-feature-settings:'ss02' 1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}pre{-webkit-font-smoothing:auto;-moz-osx-font-smoothing:auto;overflow-x:auto;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo, Monaco,Courier New,monospace;}body{margin:0;overflow-x:hidden;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:opacity 0.025s linear;transition:opacity 0.025s linear;}a:hover{opacity:0.75;}a.no-hover:hover{opacity:1;}.hover_box_overlay{opacity:0;-webkit-transition:opacity 0.025s linear;transition:opacity 0.025s linear;}.hover_box:hover .hover_box_overlay{opacity:1;}a.gray-backer{-webkit-transition:background 0.05s linear;transition:background 0.05s linear;}a.gray-backer:hover{background:#f3f3f3;}button:focus{outline:#999 auto 3px;}</style><style id="__jsx-3344216300">html{font-size:17.189999999999998px;line-height:25.784999999999997px;}a,.display-link{background-image:linear-gradient( to right, black 100%, transparent 0% );background-position:0em calc(1.07em);background-repeat:repeat-x;background-size:1em 0.07em;}a.no-underline{background-image:none;}a.no-hover{background-image:none;}a.no-hover:hover{background-image:none;opacity:1;}</style><style id="__jsx-2959859206">h1,h2,h3,h4,h5,h6{font-weight:400;font-style:normal;margin:0;}h1{font-size:51.56999999999999px;line-height:1.25;}h2{font-size:34.379999999999995px;line-height:1.25;padding-top:25.784999999999997px;margin-bottom:25.784999999999997px;}h3{font-size:25.784999999999997px;line-height:1.25;padding-top:25.784999999999997px;margin-bottom:25.784999999999997px;}h4{font-size:21.487499999999997px;line-height:1.25;padding-top:0px;margin-bottom:25.784999999999997px;}h5{font-size:12.892499999999998px;line-height:1.4375;margin-bottom:12.892499999999998px;padding-bottom:12.892499999999998px;margin-top:-12.892499999999998px;}p{margin:0 0 25.784999999999997px 0;}ol,ul{margin:0 0 25.784999999999997px 0;padding-left:25.784999999999997px;}blockquote{margin:0 0 25.784999999999997px 25.784999999999997px;}.html-video-holder{margin:0 0 25.784999999999997px 0;}video{max-width:100%;}code{background:#eaeaea;padding-right:3px;padding-left:3px;font-size:0.975em;word-break:break-word;}</style><style id="__jsx-1135431938">code[class*='language-'],pre[class*='language-']{color:black;background:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}pre[class*='language-']::-moz-selection,pre[class*='language-']::-moz-selection,code[class*='language-']::-moz-selection,code[class*='language-']::-moz-selection{text-shadow:none;}pre[class*='language-']::selection,pre[class*='language-']::selection,code[class*='language-']::selection,code[class*='language-']::selection{text-shadow:none;}@media print{code[class*='language-'],pre[class*='language-']{text-shadow:none;}}:not(pre)>code[class*='language-']{white-space:normal;}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:slategray;}.token.punctuation{color:#999;}.namespace{opacity:0.7;}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905;}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690;}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#9a6e3a;}.token.atrule,.token.attr-value,.token.keyword{color:#07a;}.token.function,.token.class-name{color:#dd4a68;}.token.regex,.token.important,.token.variable{color:#e90;}.token.important,.token.bold{font-weight:bold;}.token.italic{font-style:italic;}.token.entity{cursor:help;}</style></head><body><div id="__next"><div class="jsx-4059783939 jsx-3344216300 js-no-flash"><div style="padding-bottom:12.892499999999998px"><div style="position:relative"><div style="position:relative;padding:6.446249999999999px 12.892499999999998px 6.446249999999999px 12.892499999999998px;background-image:url(&quot;/static/images/dataline.png&quot;)"><div style="display:flex;justify-content:space-between"><div style="display:flex;align-items:center;height:25.784999999999997px;padding-top:1px"><a href="https://www.cloudera.com/products/fast-forward-labs-research.html" style="display:block;line-height:0" class="no-underline no-hover"><img style="height:12.892499999999998px" src="/static/images/cloudera.png"/></a></div><div style="display:flex;align-items:center;padding-top:1px;font-size:17.189999999999998px;line-height:1.5"><a class="no-underline" href="https://www.cloudera.com/products/fast-forward-labs-research.html" style="color:#333e47;font-size:12.892499999999998px;line-height:1.5">About Us →</a></div></div><div style="position:absolute;left:0;width:100%;height:2px;transform:scaleY(0.60165);transform-origin:center center;background:rgba(0,0,0,0.125);bottom:-1px"></div></div><div style="padding:12.892499999999998px 12.892499999999998px 12.892499999999998px 12.892499999999998px;display:flex;justify-content:space-between;font-size:17.189999999999998px;line-height:1.5"><div style="display:flex;align-items:center"><a class="no-hover no-underline" style="display:flex;align-items:center" href="/"><img style="height:18.75272727272727px;width:18.75272727272727px;margin-right:9.669374999999999px;position:relative;top:-0.5860227272727272px" src="/static/images/ff.png"/><div>Fast Forward Labs </div></a></div><div style="display:flex;align-items:center;height:25.784999999999997px"></div><div style="display:flex"><div style="margin-right:12.892499999999998px"><a href="/">Blog</a></div><div><a href="https://experiments.fastforwardlabs.com">AI Experiments</a></div></div></div><div style="position:absolute;left:0;width:100%;height:2px;transform:scaleY(0.60165);transform-origin:center center;background:black;bottom:-1px"></div></div></div><div class="jsx-1135431938 jsx-2959859206"><div style="position:relative" class="jsx-1135431938 jsx-2959859206"><div style="padding-left:6.446249999999999px;padding-right:6.446249999999999px;padding-top:25.784999999999997px" class="jsx-1135431938 jsx-2959859206"><div class="jsx-1135431938 jsx-2959859206"><div style="display:flex;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206"><div style="width:293.55375px;padding:0px 12.892499999999998px;position:relative;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1" class="jsx-1135431938 jsx-2959859206">Jan 01 2018</div><div style="width:293.55375px;padding:0px 12.892499999999998px;position:relative;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1" class="jsx-1135431938 jsx-2959859206">post</div></div><div style="margin-bottom:0" class="jsx-1135431938 jsx-2959859206"><div style="font-size:42.974999999999994px;line-height:1.25;padding:0px 12.892499999999998px;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206">Exploring Recommendation Systems</div></div><div style="display:flex;flex-wrap:wrap;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206"><div style="padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px;width:587.1075px" class="jsx-1135431938 jsx-2959859206"><div class="jsx-1135431938 jsx-2959859206">by<!-- --> <a href="https://twitter.com/shioulin_sam" class="jsx-1135431938 jsx-2959859206">Shioulin</a></div></div><div style="width:587.1075px;padding:25.784999999999997px 12.892499999999998px 25.784999999999997px 12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><p>While we commonly associate recommendation systems with e-commerce, their
application extends to any decision-making problem which requires pairing two
types of things together. To understand why recommenders don&#x27;t always work as
well as we&#x27;d like them to, we set out to build some basic recommendation systems
using publicly available data.</p><h2>Data</h2><p>The first ingredient for building a recommendation system is user interaction
data. We experimented with two different datasets, one from Flickr and one from
Amazon. The Flickr dataset contains interactions between users and photos that
they liked; the Amazon dataset contains user ratings on books. Both datasets are
time-stamped. The Flickr dataset has positive class data only (i.e. liked
photos), while the Amazon dataset has granular ratings data ranging from 1 to 5.</p><p>In general, user interaction data is <em>sparse,</em> since a single user would only
have interacted with a small subset of items (think about how many movies you
have rated on Netflix). In addition, users tend to rate good items only, leading
to class imbalance. For datasets with granular ratings data, not only is it hard
for a user to differentiate 2 from 3, a 3 could also mean different things to
different users.</p><p>In recommendation systems, it is important to remove both users who have
interacted with many items and items that have many ratings. Intuitively, users
who like many items do not add any useful information to our system, as they are
not selective enough. Similarly, items that many users like will tend to be
overly recommended. To clean our dataset, we filtered out these cases. We then
split the dataset into two (training and testing), using a cutoff timestamp.</p><h2>Building the Recommender</h2><p>The goal of a recommendation system is to use historical interaction data to
recommend a new pairing (user and item) for the future. There are two
approaches. The first approach predicts an actual rating for a user-item pair
and recommends the highest rated item for that user. The second approach
predicts a ranking of items and recommends the highest ranked item for a
user. Our experiment focuses on the first approach. The recommenders are
evaluated using standard metrics such as area under curve (AUC) and root mean
squared error (RMSE).</p><p>AUC computes the area under the ROC curve for classification problems, and a
larger number is better. The
<a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">ROC</a> curve
plots the true positive rate against the false positive rate. We want a
classifier that correctly identifies as many positive instances as are available, with
a very low percentage of negative instances incorrectly classified as
positive. As a result, the ROC curve of a perfect classifier will go straight up
the y axis (true positive rate) and then along the x axis (false positive
rate). A classifier with no power will sit on the x=y diagonal. RMSE computes
how far the predicted value is from the actual value.</p><h3>Basic photo recommendation system</h3><p>To quickly get a recommender up and running, we used a Python scikit called
<a href="https://github.com/NicolasHug/Surprise">SURPRISE</a>. The package has various
built-in recommendation algorithms including ones based on neighborhood approach
and matrix factorization. Neighborhood approach finds a group of users who are
similar to you and assumes that you share the same item preferences. The
algorithm then recommends to you items that these users have liked. Matrix
factorization represents users and items using a set of factors and predicts
user preference for items using a linear combination of these factors. Because a
recommender needs to know both what a user liked and disliked, we used
heuristics to infer negative ratings for the Flickr dataset. (An example
heuristic is to assume that <em>x</em> number of photos before the <em>liked</em> photo are
disliked.)</p><p>With both positive and negative ratings, we were ready to plug our data into
SURPRISE. To do so, we transformed it into a text file that provides four pieces
of information {userid, photoid, rating, timestamp}, where a rating is either a 1
or 5.</p><p>The following code snippet shows how custom datasets can be defined and used in
SURPRISE. </p><div><div style="position:relative;margin-bottom:25.784999999999997px;width:602px;margin-left:-20.338749999999997px;margin-right:-20.338749999999997px"><div class="prism-code language-python" style="overflow-x:auto;overflow-y:hidden;background:#f3f3f3"><pre style="float:left;font-size:12.892499999999998px;min-width:100%;position:relative;line-height:1.5;margin:0;padding:12.892499999999998px;overflow:visible"><div class="token-line"><span><span class="token keyword">from</span><span class="token plain"> surprise </span><span class="token keyword">import</span><span class="token plain"> Dataset</span></span></div><div class="token-line"><span><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> surprise </span><span class="token keyword">import</span><span class="token plain"> Reader</span></span></div><div class="token-line"><span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">train_file </span><span class="token operator">=</span><span class="token plain"> os</span><span class="token punctuation">.</span><span class="token plain">path</span><span class="token punctuation">.</span><span class="token plain">expanduser</span><span class="token punctuation">(</span><span class="token plain">data_path </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27;train.data&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">test_file </span><span class="token operator">=</span><span class="token plain"> os</span><span class="token punctuation">.</span><span class="token plain">path</span><span class="token punctuation">.</span><span class="token plain">expanduser</span><span class="token punctuation">(</span><span class="token plain">data_path </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string">&#x27;test.data&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">reader </span><span class="token operator">=</span><span class="token plain"> Reader</span><span class="token punctuation">(</span><span class="token plain">line_format</span><span class="token operator">=</span><span class="token string">&#x27;user item rating timestamp&#x27;</span><span class="token punctuation">,</span><span class="token plain"> sep</span><span class="token operator">=</span><span class="token string">&#x27;;&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">data </span><span class="token operator">=</span><span class="token plain"> Dataset</span><span class="token punctuation">.</span><span class="token plain">load_from_folds</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token plain">train_file</span><span class="token punctuation">,</span><span class="token plain"> test_file</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> reader</span><span class="token operator">=</span><span class="token plain">reader</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div></pre><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><p>Training a model and getting a prediction is straightforward.</p><div><div style="position:relative;margin-bottom:25.784999999999997px;width:602px;margin-left:-20.338749999999997px;margin-right:-20.338749999999997px"><div class="prism-code language-python" style="overflow-x:auto;overflow-y:hidden;background:#f3f3f3"><pre style="float:left;font-size:12.892499999999998px;min-width:100%;position:relative;line-height:1.5;margin:0;padding:12.892499999999998px;overflow:visible"><div class="token-line"><span><span class="token keyword">from</span><span class="token plain"> surprise </span><span class="token keyword">import</span><span class="token plain"> dump</span></span></div><div class="token-line"><span><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> surprise </span><span class="token keyword">import</span><span class="token plain"> KNNBasic</span></span></div><div class="token-line"><span><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> surprise</span><span class="token punctuation">.</span><span class="token plain">accuracy </span><span class="token keyword">import</span><span class="token plain"> rmse</span></span></div><div class="token-line"><span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">algo </span><span class="token operator">=</span><span class="token plain"> KNNBasic</span><span class="token punctuation">(</span><span class="token plain">sim_options</span><span class="token operator">=</span><span class="token plain">sim_options</span><span class="token punctuation">,</span><span class="token plain"> min_k</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span><span class="token keyword">for</span><span class="token plain"> trainset</span><span class="token punctuation">,</span><span class="token plain"> testset </span><span class="token keyword">in</span><span class="token plain"> data</span><span class="token punctuation">.</span><span class="token plain">folds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">    algo</span><span class="token punctuation">.</span><span class="token plain">train</span><span class="token punctuation">(</span><span class="token plain">trainset</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">    predictions </span><span class="token operator">=</span><span class="token plain"> algo</span><span class="token punctuation">.</span><span class="token plain">test</span><span class="token punctuation">(</span><span class="token plain">testset</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">    rmse</span><span class="token punctuation">(</span><span class="token plain">predictions</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">    dump</span><span class="token punctuation">(</span><span class="token string">&#x27;./dump_KNN&#x27;</span><span class="token punctuation">,</span><span class="token plain"> predictions</span><span class="token punctuation">,</span><span class="token plain"> trainset</span><span class="token punctuation">,</span><span class="token plain"> algo</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div></pre><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><p>The ROC curve for our system was underwhelming - it is very close to the diagonal
line because there is not enough information in the interaction matrix.</p><p><div style="position:relative"><img src="/static/images/2018/01/ROC_NMF_nodot_1115.png" style="display:block;margin:0;width:100%"/></div></p><h3>Photo recommender with Tags</h3><p>Could we build a better recommendation system if we made use of the tag
information that comes for free with the Flickr dataset? Instead of describing a
photo using its id (a series of numbers), we used tags like <em>sunset, bridge,
Brooklyn</em>. Why? First, by doing so, we hoped to add more information to the
interaction matrix. Second, our basic photo recommender was unable to recommend
a new photo because it did not have any historical interaction
information. Since it did not know who had interacted with this photo and what
the outcome of the interaction was, it did not know how to recommend this new
item. (This is known as the <em>cold start</em> problem.) By adding tags, we built
a system that understands the content of what it is recommending. With this
understanding comes the ability to recommend items that it has never seen
before. A new photo is no longer new to the system; it can be represented by a
set of tags that the system has seen before.</p><p>When we describe a photo with a set of tags, each column of the input matrix is
now a tag (vs a photo id). As such, the size of the input matrix becomes much
larger. For each user, the recommender returns a set of tags and their
corresponding scores. To get back a photo recommendation, these tag scores need
to be converted to photo scores. For each photo, we compute its score by i)
comparing the recommended tags to the set of tags representing the photo, ii)
finding the common tags between them, iii) adding up the scores for the common
tags and iv) normalizing by the number of common tags. All photos are ranked
using this score and the top one is recommended. Once tag information is
incorporated, our ROC curve looked much better!</p><p><div style="position:relative"><img src="/static/images/2018/01/ROC_NMF_tag_loop_1115_nodot.png" style="display:block;margin:0;width:100%"/></div></p><h3>Basic book recommendation system</h3><p>Our recommender based on Flickr&#x27;s dataset required inferred negative
ratings. Amazon&#x27;s user rating dataset, on the other hand, provides rating
information ranging from 1 to 5. We tested two recommenders on this dataset: the
first was a recommender we built using Python&#x27;s scikit-learn package; the second
was a recommender put together using
<a href="https://github.com/maciejkula/spotlight">Spotlight</a>, a PyTorch based
recommendation package. In our scikit-learn implementation we incorporated both
matrix factorization and neighborhood-based algorithms. In the Spotlight
recommender, we built an engine using matrix factorization since Spotlight does
not support neighborhood based-approaches. All recommenders are evaluated using
RMSE.</p><p>We cleaned and separated the Amazon dataset into training and testing sets using the same
approach as we did with the Flickr dataset. From here, we transformed the input data into an
interaction matrix for our sklearn-based recommender. Each row in the
interaction matrix represents a user and each column represents a book. For
Spotlight, this interaction matrix is converted into a custom <em>interactions</em>
object. This object takes in three arrays: user ID, book ID, and ratings
information. The user ID is the row index for our interaction matrix, the book
ID is the column index, and the rating information is the value of the
interaction matrix. Here is the code snippet. </p><div><div style="position:relative;margin-bottom:25.784999999999997px;width:602px;margin-left:-20.338749999999997px;margin-right:-20.338749999999997px"><div class="prism-code language-python" style="overflow-x:auto;overflow-y:hidden;background:#f3f3f3"><pre style="float:left;font-size:12.892499999999998px;min-width:100%;position:relative;line-height:1.5;margin:0;padding:12.892499999999998px;overflow:visible"><div class="token-line"><span><span class="token keyword">from</span><span class="token plain"> spotlight</span><span class="token punctuation">.</span><span class="token plain">interactions </span><span class="token keyword">import</span><span class="token plain"> Interactions</span></span></div><div class="token-line"><span><span class="token plain">interactions </span><span class="token operator">=</span><span class="token plain"> Interactions</span><span class="token punctuation">(</span><span class="token plain">np</span><span class="token punctuation">.</span><span class="token plain">asarray</span><span class="token punctuation">(</span><span class="token plain">userid</span><span class="token punctuation">,</span><span class="token plain"> dtype</span><span class="token operator">=</span><span class="token plain">np</span><span class="token punctuation">.</span><span class="token plain">int32</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">                    np</span><span class="token punctuation">.</span><span class="token plain">asarray</span><span class="token punctuation">(</span><span class="token plain">bookid</span><span class="token punctuation">,</span><span class="token plain"> dtype</span><span class="token operator">=</span><span class="token plain">np</span><span class="token punctuation">.</span><span class="token plain">int32</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">                            np</span><span class="token punctuation">.</span><span class="token plain">asarray</span><span class="token punctuation">(</span><span class="token plain">ratings_all</span><span class="token punctuation">,</span><span class="token plain"> dtype</span><span class="token operator">=</span><span class="token plain">np</span><span class="token punctuation">.</span><span class="token plain">float32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div></pre><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><p>Training and scoring the model is a two liner.</p><div><div style="position:relative;margin-bottom:25.784999999999997px;width:602px;margin-left:-20.338749999999997px;margin-right:-20.338749999999997px"><div class="prism-code language-python" style="overflow-x:auto;overflow-y:hidden;background:#f3f3f3"><pre style="float:left;font-size:12.892499999999998px;min-width:100%;position:relative;line-height:1.5;margin:0;padding:12.892499999999998px;overflow:visible"><div class="token-line"><span><span class="token keyword">from</span><span class="token plain"> spotlight</span><span class="token punctuation">.</span><span class="token plain">factorization</span><span class="token punctuation">.</span><span class="token plain">explicit </span><span class="token keyword">import</span><span class="token plain"> ExplicitFactorizationModel</span></span></div><div class="token-line"><span><span class="token plain"></span><span class="token keyword">from</span><span class="token plain"> spotlight</span><span class="token punctuation">.</span><span class="token plain">evaluation </span><span class="token keyword">import</span><span class="token plain"> rmse_score</span></span></div><div class="token-line"><span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">model </span><span class="token operator">=</span><span class="token plain"> ExplicitFactorizationModel</span><span class="token punctuation">(</span><span class="token plain">n_iter</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">model</span><span class="token punctuation">.</span><span class="token plain">fit</span><span class="token punctuation">(</span><span class="token plain">sp_train</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">rmse </span><span class="token operator">=</span><span class="token plain"> rmse_score</span><span class="token punctuation">(</span><span class="token plain">model</span><span class="token punctuation">,</span><span class="token plain"> sp_test</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain">  </span><span class="token comment"># 0.62</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div></pre><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><p>Similar to our results with the Flickr dataset, the initial results were underwhelming, but expected for a
system built using only user and book ratings information.</p><h3>Book Recommender with Subject</h3><p>What if we added some content information to the books? In the Flickr dataset,
each photo already has a set of tags associated with it; content information is
free! For the Amazon dataset, we obtained subject information using the open
library API. This allowed us to identify a book using its subject. Each column in
our interaction matrix is now a subject rather than a book ID. Since multiple
books can be mapped to the same subject, our input matrix is smaller and
denser. (This is in contrast to the Flickr dataset, where adding content
information expanded the input matrix.) Ratings that a user assigned for books
with the same subject are aggregated into a single rating for that particular
subject. To obtain a recommended rating on a book, we mapped the book to its
subject and read off that recommendation. With subject information, the RMSE
improved by approximately 2-fold across the board! Unfortunately, we also saw
that most of the algorithms do not work since they perform worse than a random
recommender when we use RMSE as a metric.</p><table><thead><tr><th align="center">Algorithm</th><th align="center">RMSE</th></tr></thead><tbody><tr><td align="center">NMF (ID)</td><td align="center">0.84</td></tr><tr><td align="center">NMF (Subject)</td><td align="center">0.46</td></tr><tr><td align="center">Neighborhood (ID)</td><td align="center">0.84</td></tr><tr><td align="center">Neighborhood (Subject)</td><td align="center">0.44</td></tr><tr><td align="center">Spotlight MF (ID)</td><td align="center">0.62</td></tr><tr><td align="center">Spotlight MF (Subject)</td><td align="center">0.27</td></tr><tr><td align="center">Random</td><td align="center">0.38</td></tr></tbody></table><h2>What we learned</h2><h3>Raw material</h3><p>Data makes all the difference. Traditional recommendation systems do not work
well because of the sparsity problem. Each user only rates a small percentage of
items in the universe, but recommendation systems rely on this weak signal to
make decisions.</p><p>To make a better system we need a denser matrix in order to extract a stronger
signal. In our example we used content information: tags for the Flickr dataset
and subjects for the Amazon dataset. Both cases saw dramatic
improvements. </p><p>Time-stamp information is also helpful because it makes the
problem amenable to some deep learning techniques. As an example, the prototype we built to
accompany our new Semantic Recommendations report uses deep features as a way of
extending the factorization models.</p><h3>Does a basic recommendation system work?</h3><p>A recommendation system built using matrix factorization or neighborhood
approaches trained on simple user-item interaction data is unlikely to give
great recommendations. In our experiment with the Amazon dataset, these
recommendation systems underperform a random system! Moreover, these systems
suffer from the cold start problem - they rely on historical interaction data
and cannot make recommendations on new items.</p><p>For more on recommendation systems, please see our new report! The Semantic
Recommendations report explores the current state of recommendation systems,
with a focus on how machines can better understand content. Armed with this
newfound understanding, we look at how systems can bypass the cold start problem
and expand their utility well beyond traditional e-commerce use cases.</p><div style="display:none;justify-content:center;padding:12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><img style="height:18.75272727272727px;width:18.75272727272727px;position:relative;display:block" src="/static/images/ff.png" class="jsx-1135431938 jsx-2959859206"/></div></div></div></div><div style="position:relative;display:block;width:612.8924999999999px;grid-template-columns:repeat(2, 1fr);margin-left:-12.892499999999998px;margin-right:-12.892499999999998px"><div style="display:grid"><div style="position:relative;display:grid;grid-template-rows:auto 1fr;margin-bottom:12.892499999999998px"><div style="text-transform:uppercase;font-size:12.892499999999998px;letter-spacing:0.03em;line-height:1.5;padding-bottom:6.446249999999999px;padding-left:25.784999999999997px">Newer</div><div style="position:relative;display:grid"><a class="hover-box no-underline no-hover gray-backer hover-extend" style="display:block;position:relative;width:612.8925px;padding-left:12.892499999999998px;padding-right:12.892499999999998px;margin-left:0;margin-right:0" href="/2018/01/26/google-mapss-competitive-moat-why-better-data-matters.html"><div style="display:flex;flex-wrap:wrap"><div style="display:flex;width:587.1075px;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1.5;margin-left:0"><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>Jan 06 2018</div></div><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>Newsletter</div></div></div><div style="position:relative;width:587.1075px;padding:12.892499999999998px 0px"><div style="font-size:25.784999999999997px;line-height:1.25;padding:0px 12.892499999999998px;margin-top:-6.446249999999999px"><div style="padding-left:0">Google Maps&#x27; Competitive Moat - Why Better Data Matters</div></div><div style="padding-top:6.446249999999999px;position:relative"><div style="font-size:15.041249999999998px;line-height:1.5em;display:flex;flex-wrap:wrap;padding-left:0"><div style="padding:0px 12.892499999999998px;width:293.55375px"><div style="height:90.24749999999999px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:4;hyphens:auto;-webkit-box-orient:vertical">
Justin O&#x27;Beirne recently wrote a blog post surveying the landscape of mapping apps and sites (with particular focus on Google Maps and Apple Maps). This is one of a series of pieces O&#x27;Beirne has written comparing Google and Apple Maps. In short, O&#x27;Beirne concludes that Google...</div><div style="overflow:hidden;width:100%;text-overflow:ellipsis;white-space:nowrap"><span class="display-link"><span>View<!-- --> <span style="text-transform:lowercase">Newsletter</span></span></span></div></div><div style="position:relative;width:293.55375px"><div style="width:calc(100% - 25.784999999999997px);height:calc(100% - 12.892499999999998px);margin-left:12.892499999999998px;margin-top:6.446249999999999px;background-image:url(/static/images/2018/01/Smith_Court_Area_of_Interest-1516748269178.JPG);background-size:contain;background-position:center center;background-repeat:no-repeat"></div></div></div></div></div></div></a><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><div style="display:grid"><div style="position:relative;display:grid;grid-template-rows:auto 1fr;margin-bottom:12.892499999999998px"><div style="text-transform:uppercase;font-size:12.892499999999998px;letter-spacing:0.03em;line-height:1.5;padding-bottom:6.446249999999999px;padding-left:25.784999999999997px">Older</div><div style="position:relative;display:grid"><a class="hover-box no-underline no-hover gray-backer hover-extend" style="display:block;position:relative;width:612.8925px;padding-left:12.892499999999998px;padding-right:12.892499999999998px;margin-left:0;margin-right:0" href="/2017/12/20/2017-highlights.html"><div style="display:flex;flex-wrap:wrap"><div style="display:flex;width:587.1075px;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1.5;margin-left:0"><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>Dec 03 2017</div></div><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>post</div></div></div><div style="position:relative;width:587.1075px;padding:12.892499999999998px 0px"><div style="font-size:25.784999999999997px;line-height:1.25;padding:0px 12.892499999999998px;margin-top:-6.446249999999999px"><div style="padding-left:0">Highlights of 2017</div></div><div style="padding-top:6.446249999999999px;position:relative"><div style="font-size:15.041249999999998px;line-height:1.5em;display:flex;flex-wrap:wrap;padding-left:0"><div style="padding:0px 12.892499999999998px;width:293.55375px"><div style="height:90.24749999999999px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:4;hyphens:auto;-webkit-box-orient:vertical"><span>by <!-- -->CFFL<!-- --> ◦ </span>
We end 2017 with a round-up of some of the research, talks, sci-fi,
visualizations/art, and a grab bag of other stuff we found particularly
interesting, enjoyable, or influential this year.

Stars from around the world

Stars from around the world. Image credit: Kyle McDonald...</div><div style="overflow:hidden;width:100%;text-overflow:ellipsis;white-space:nowrap"><span class="display-link"><span>View<!-- --> <span style="text-transform:lowercase">post</span></span></span></div></div><div style="position:relative;width:293.55375px"><div style="width:calc(100% - 25.784999999999997px);height:calc(100% - 12.892499999999998px);margin-left:12.892499999999998px;margin-top:6.446249999999999px;background-image:url(/static/images/2017/12/stars.jpg);background-size:contain;background-position:center center;background-repeat:no-repeat"></div></div></div></div></div></div></a><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div></div><div style="padding-bottom:25.784999999999997px;padding-top:25.784999999999997px" class="jsx-1135431938 jsx-2959859206"><div style="font-size:34.379999999999995px;line-height:1.25;padding:0px 12.892499999999998px 0px 12.892499999999998px;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206">About</div><div style="padding:0px 12.892499999999998px;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0;font-size:17.189999999999998px;line-height:1.5" class="jsx-1135431938 jsx-2959859206">Cloudera Fast Forward Labs is an applied machine learning research group. We help organizations recognize and develop new product and business opportunities through emerging technologies.<!-- --> </div><div style="padding:0px 12.892499999999998px;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0;font-size:17.189999999999998px;line-height:1.5" class="jsx-1135431938 jsx-2959859206"><a href="https://www.cloudera.com/products/fast-forward-labs-research.html" class="jsx-1135431938 jsx-2959859206">Learn more about working with us.</a></div></div></div><div class="jsx-1135431938 jsx-2959859206"><div style="position:relative" class="jsx-1135431938 jsx-2959859206"><div style="position:absolute;left:0;width:100%;height:2px;transform:scaleY(0.60165);transform-origin:center center;background:black;top:-1px"></div><div style="padding:12.892499999999998px;display:flex;justify-content:space-between;flex-wrap:wrap;font-size:17.189999999999998px;line-height:1.5" class="jsx-1135431938 jsx-2959859206"><div class="jsx-1135431938 jsx-2959859206"><a href="/" class="jsx-1135431938 jsx-2959859206">Blog</a></div><div style="display:flex;flex-wrap:wrap" class="jsx-1135431938 jsx-2959859206"><div style="margin-right:12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><a href="https://www.cloudera.com/products/fast-forward-labs-research.html" class="jsx-1135431938 jsx-2959859206">Cloudera</a></div><div style="margin-right:12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><a href="https://blog.fastforwardlabs.com/" class="jsx-1135431938 jsx-2959859206">AI Experiments</a></div><div class="jsx-1135431938 jsx-2959859206"><a href="https://twitter.com/fastforwardlabs" class="jsx-1135431938 jsx-2959859206">Twitter</a></div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/posts/2018-01-22-exploring-recommendation-systems","query":{},"buildId":"EnU~FBvqy_55fWO5RkIyH","nextExport":true}</script><script async="" id="__NEXT_PAGE__/posts/2018-01-22-exploring-recommendation-systems" src="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/posts/2018-01-22-exploring-recommendation-systems.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/_app.js"></script><script src="/_next/static/runtime/webpack-fdce77a122c11e06ae50.js" async=""></script><script src="/_next/static/chunks/commons.f77b50de979bfbbb280b.js" async=""></script><script src="/_next/static/runtime/main-5ab107747766f1b4e0bf.js" async=""></script></body></html>