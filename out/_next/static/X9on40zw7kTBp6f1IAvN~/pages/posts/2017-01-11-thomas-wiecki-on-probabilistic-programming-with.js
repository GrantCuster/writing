(window.webpackJsonp=window.webpackJsonp||[]).push([["76e1"],{EMYU:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",function(){return r}),a.d(t,"default",function(){return l});var i=a("kOwS"),o=a("qNsG"),n=(a("q1tI"),a("E/Ix")),r={title:"Thomas Wiecki on Probabilistic Programming with PyMC3",date:new Date("2017-01-11T14:23:11.000Z"),layout:"post",preview_image:"https://68.media.tumblr.com/b1cc21602fec1b350032b5b79db93552/tumblr_inline_ojmc1prF0t1ta78fg_540.png",post_type:"Interview",interview_with:"Thomas Wiecki",feature:!0,interview_with_link:"https://twitter.com/twiecki",redirect_from:["/post/155718521293/thomas-wiecki-on-probabilistic-programming-with"]},s={frontMatter:r},c="wrapper";function l(e){var t=e.components,a=Object(o.a)(e,["components"]);return Object(n.b)(c,Object(i.a)({},s,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)("p",null,Object(n.b)("img",Object(i.a)({parentName:"p"},{src:"https://68.media.tumblr.com/b1cc21602fec1b350032b5b79db93552/tumblr_inline_ojmc1prF0t1ta78fg_540.png",alt:null}))),Object(n.b)("h5",null,"A ",Object(n.b)("a",Object(i.a)({parentName:"h5"},{href:"https://blog.quantopian.com/bayesian-correlation-estimation/"}),"rolling regression with PyMC3"),": instead of the regression coefficients being constant over time (the points are daily stock prices of 2 stocks), this model assumes they follow a random-walk and can thus slowly adapt them over time to fit the data best."),Object(n.b)("p",null,"Probabilistic programming is coming of age. While normal programming languages denote procedures, probabilistic programming languages denote models and perform inference on these models. Users write code to specify a model for their data, and the languages run sampling algorithms across probability distributions to output answers with confidence rates and levels of uncertainty across a full distribution. These languages, in turn, open up a whole range of analytical possibilities that have historically been too hard to implement in commercial products."),Object(n.b)("p",null,"One sector where probabilistic programming will likely have significant impact is financial services. Be it when predicting future market behavior or loan defaults, when analyzing individual credit patterns or anomalies that might indicate fraud, financial services organizations live and breathe risk. In that world, a tool that makes it easy and fast to predict future scenarios while quantifying uncertainty could have tremendous impact. That’s why ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://twitter.com/twiecki"}),"Thomas Wiecki"),", Director of Data Science for the crowdsourced investment management firm ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://www.quantopian.com/"}),"Quantopian"),", is so excited about probabilistic programming and the ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/pymc-devs/pymc3/blob/master/RELEASE-NOTES.md#pymc3-30-january-9-2017"}),"new release of PyMC3 3.0"),"."),Object(n.b)("p",null,"We interviewed Dr. Wiecki to get his thoughts on why probabilistic programming is taking off now and why he thinks it’s important. Check out ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://twiecki.github.io/"}),"his blog"),", and keep reading for highlights!"),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"A key benefit of probabilistic programming is that it makes it easier to construct and fit ",Object(n.b)("a",Object(i.a)({parentName:"strong"},{href:"http://www.kdnuggets.com/2016/11/how-bayesian-inference-works.html"}),"Bayesian inference models"),". You have a history working with Bayesian methods in your doctoral work on cognition and psychiatry. How did you use them?")),Object(n.b)("p",null,"One of the main problems in psychiatry today is that disorders like depression or schizophrenia are diagnosed based purely on subjective reporting of symptoms, not biological traits you can measure. By way of comparison, imagine if a cardiologist were to prescribe heart medication based on answers you gave in a questionnaire! Even the categories used to diagnose depression aren’t that valid, as two patients may have completely different symptoms, caused by different underlying biological mechanisms, but both fall under the broad category “depressed.” My thesis tried to change that by identifying differences in cognitive function -- rather than reported symptoms -- to diagnose psychiatric diseases. Towards that goal, we used computational models of the brain, estimated in a Bayesian framework, to try to measure cognitive function. Once we had accurate measures of cognitive function, we used machine learning to train classifiers to predict whether individuals were suffering from certain psychiatric or neurological disorders. The ultimate goal was to replace disease categories based on subjective descriptions of symptoms with objectively measurable cognitive function. This new field of research is generally known as computational psychiatry, and is starting to take root in industries like pharmaceuticals to test the efficacy of new drugs."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"What exactly was Bayesian about your approach?")),Object(n.b)("p",null,"We mainly used it to get accurate fits of our models to behavior. Bayesian methods are especially powerful when there is hierarchical structure in data. In computational psychiatry, individual subjects either belong to a healthy group or a group with psychiatric disease. In terms of cognitive function, individuals are likely to share similarities with other members of their group. Including these groupings into a hierarchical model gave more powerful and informed estimates about individual subjects so we could make better and more confident predictions with less data.\n",Object(n.b)("img",Object(i.a)({parentName:"p"},{src:"https://68.media.tumblr.com/737677967b59d144b5bb001a995c6225/tumblr_inline_ojmd6kOzGi1ta78fg_540.png",alt:null}))),Object(n.b)("h5",null,"Bayesian inference ",Object(n.b)("a",Object(i.a)({parentName:"h5"},{href:"http://pymc-devs.github.io/pymc3/notebooks/BEST.html"}),"provides robust means to test hypotheses")," by estimating how different two different groups are from one another."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"How did you go from computational psychiatry to data science at Quantopian?")),Object(n.b)("p",null,"I started working part-time at Quantopian during my PhD and just loved the process of building an actual product and solving really difficult applied problems. After I finished my PhD, it was an easy decision to come on full-time and lead the data science efforts there. Quantopian is a community of over 100.000 scientists, developers, students, and finance professionals interested in algorithmic trading. We provide all the tools and data necessary to build state-of-the-art trading algorithms. As a company, we try to identify the most promising algorithms and work with the authors to license them for our upcoming fund, which will launch later this year.  The authors retain the IP of their strategy and get a share of the net profits."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"What’s one challenging data science problem you face at Quantopian?")),Object(n.b)("p",null,"Identifying the best strategies is a really interesting data science problem because people often overfit their strategies to historical data. A lot of strategies thus often look great historically but falter when actually used to trade with real money. As such, we let strategies bake in the oven a bit and accumulate out-of-sample data that the author of the strategy did not have access to, simply because it hadn’t happened yet when the strategy was conceived. We want to wait long enough to gain confidence, but not so long that strategies lose their edge. Probabilistic programming allows us to track uncertainty over time, informing us when we’ve waited long enough to have confidence that the strategy is actually viable and what level of risk we take on when investing in it."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"It’s tricky to understand probabilistic programming when you first encounter it. How would you define it?")),Object(n.b)("p",null,"Probabilistic programming allows you to flexibly construct and fit Bayesian models in computer code. These ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Generative_model"}),"models are generative"),": they relate unobservable causes to observable data, to simulate how we believe data is created in the real world. This is actually a very intuitive way to express how you think about a dataset and formulate specific questions. We start by specifying a model, something like “this data fits into a normal distribution”. Then, we run flexible estimation algorithms, like ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://twiecki.github.io/blog/2015/11/10/mcmc-sampling/"}),"Markov Chain Monte Carlo")," (MCMC), to sample from the “posterior”, the distribution updated in light of our real-world data, which quantifies our belief into the most likely causes underlying the data. The key with probabilistic programming is that model construction and inference are almost completely independent. It used to be that those two were inherently tied together so you had to do a lot of math in order to fit a given model. Probabilistic programming can estimate almost any model you dream up which provides the data scientist with a lot of flexibility to iterate quickly on new models that might describe the data even better. Finally, because we operate in a Bayesian framework, the models rest on a very well thought out statistical foundation that handles uncertainty in a principled way."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Much of the math behind Bayesian inference and statistical sampling techniques like MCMC is not new, but probabilistic tooling is. Why is this taking off now?")),Object(n.b)("p",null,"There are mainly three reasons why probabilistic programming is more viable today than it was in the past. First is simply the increase in compute power, as these MCMC samplers are quite costly to run. Secondly, there have been theoretical advances in the sampling algorithms themselves, especially a new class called ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://andrewgelman.com/2015/08/05/how-hamiltonian-monte-carlo-works/"}),"Hamiltonian Monte Carlo samplers"),". These are much more powerful and efficient in how they sample data, allowing us to fit highly complex models. Instead of sampling at random, Hamiltonian samplers use the ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Gradient"}),"gradient of the model")," to focus sampling on high probability areas. By contrast, older packages like ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"BUGS")," ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"c"),"o",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"u"),"l",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"d")," ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"n"),"o",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"t")," ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"c"),"o",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"m"),"p",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"u"),"t",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"e")," ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"g"),"r",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"a"),"d",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"i"),"e",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"n"),"t",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.mrc-bsu.cam.ac.uk/software/bugs/"}),"s"),". Finally, the third required piece was software using ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://alexey.radul.name/ideas/2013/introduction-to-automatic-differentiation/"}),"automatic differentiation")," -- an automatic procedure to compute gradients on arbitrary models."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"What are the skills required to use probabilistic programming? Can any data scientist get started today or are there prerequisites?")),Object(n.b)("p",null,"Probabilistic programming is like statistics for hackers. It used to be that even basic statistical modeling required a lot of fancy math. We also used to have to sacrifice the ability to really map the complexity in data to make models that were tractable, but just too simple. For example, with probabilistic programming we don’t have to do something like assume our data is normally distributed just to make our model tractable. This assumption is everywhere because it’s mathematically convenient, but no real-world data looks like this! Probabilistic programming enables us to capture these complex distributions. The required skills are the ability to code in a language like Python and a basic knowledge of probability to be able to state your model. There are also a lot of great resources out there to get started, like ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://www.amazon.com/Bayesian-Analysis-Python-Osvaldo-Martin/dp/1785883801"}),"Bayesian Analysis with Python"),", ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers"}),"Bayesian Methods for Hackers"),", and of course the soon-to-be-released ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://twitter.com/FastForwardLabs/status/811294428287602688"}),"Fast Forward Labs report"),"!"),Object(n.b)("p",null,Object(n.b)("img",Object(i.a)({parentName:"p"},{src:"https://68.media.tumblr.com/02d389bceba76f171f88b0dde6e77850/tumblr_inline_ojmd0oVnx31ta78fg_540.jpg",alt:null}))),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Congratulations on the ",Object(n.b)("a",Object(i.a)({parentName:"strong"},{href:"https://github.com/pymc-devs/pymc3/blob/master/RELEASE-NOTES.md#pymc3-30-january-9-2017"}),"new release of PyMC3"),"! What differentiates PyMC3 from ",Object(n.b)("a",Object(i.a)({parentName:"strong"},{href:"http://probabilistic-programming.org/wiki/Home"}),"other probabilistic programming languages"),"? What kinds of problems does it solve best? What are its limitations?")),Object(n.b)("p",null,"Thanks, we are really excited to finally release it, as PyMC3 has been under continuous development for the last 5 years! Stan and PyMC3 are among the current state-of-the-art probabilistic programming frameworks. The main difference is that Stan requires you to write models in a custom language, while PyMC3 models are pure Python code. This makes model specification, interaction, and deployment easier and more direct. In addition to advanced Hamiltonian Monte Carlo samplers, PyMC3 also features ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://arxiv.org/abs/1603.00788"}),"streaming variational inference"),", which allows for very fast model estimation on large data sets as we fit a distribution to the posterior, rather than trying to sample from it. In version 3.1, we plan to support more variational inference algorithms and GPUs, which will make things go even faster!"),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"For which applications is probabilistic programming the right tool? For which is it the wrong tool?")),Object(n.b)("p",null,"If you only care about pure prediction accuracy, probabilistic programming is probably the wrong tool. However, if you want to gain insight into your data, probabilistic programming allows you to build causal models with high interpretability. This is especially relevant in the sciences and in regulated sectors like healthcare, where predictions have to be justified and can’t just come from a black-box. Another benefit is that because we are in a Bayesian framework, we get uncertainty in our parameters and in our predictions, which is important for areas where we make high-stakes decisions under very noisy conditions, like in finance. Also, if you have prior information about a domain you can very directly build this into the model. For example, let’s say you wanted to estimate the risk of diabetes from a dataset. There are many things we already know even without looking at the data, like that high blood sugar increases that risk dramatically -- we can build that into the model by using an informed prior, something that’s not possible with most machine learning algorithms."),Object(n.b)("p",null,"Finally, hierarchical models are very powerful, but often underappreciated. A lot of data sets have an inherent hierarchical structure. For example, take individual preferences of users on a fashion website. Each individual has unique tastes, but often shares tastes with similar users. For example, people are more likely to have similar taste if they have the same sex, or are in the same age group, or live in the same city, state, or country. Such a model can leverage what it has learned from other group members and apply it back to an individual, leading to much more accurate predictions, even in the case where we might only have few data points per individual (which can lead to cold start problems in collaborative filtering). These hierarchies exist everywhere but are all too rarely taken into account properly. Probabilistic programming is the perfect framework to construct and fit hierarchical models."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Interpretability is certainly an issue with deep neural nets, which also require far more data than Bayesian models to train. Do you think Bayesian methods will be important for the future of deep learning?")),Object(n.b)("p",null,"Yes, and it’s a very exciting area! As we’re able to specify and estimate deep nets or other machine learning methods in probabilistic programming, it could really become a lingua franca that removes the barrier between statistics and machine learning, giving a common tool to do both. One thing that’s great about PyMC3 is that the underlying library is ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://deeplearning.net/software/theano/"}),"Theano"),", which was originally developed for deep learning. Theano helps bridge these two areas, combining the power nets have to extract latent representations out of high-dimensional data with variational inference algorithms to estimate models in a Bayesian framework. Bayesian deep learning is hot right now, so much so that ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://bayesiandeeplearning.org/"}),"NIPS offered a day-long workshop"),". I’ve also written about the benefits in ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://twiecki.github.io/blog/2016/06/01/bayesian-deep-learning/"}),"this post")," and ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://twiecki.github.io/blog/2016/07/05/bayesian-deep-learning/"}),"this post"),", explaining how Bayesian methods provide more rigor around the uncertainty and estimations of deep net predictions and provides better simulations. Finally, Bayesian Deep Learning will also allow to build exciting new architectures, like Hierarchical Bayesian Deep Networks that are useful for transfer learning. A bit like the work you did to get ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://blog.fastforwardlabs.com/2015/11/17/when-dog-is-enough-using-hypernyms-to-improve.html"}),"stronger results from Pictograph")," using the Wordnet hierarchy.\n",Object(n.b)("img",Object(i.a)({parentName:"p"},{src:"https://68.media.tumblr.com/2c74f298da1db480e279000484401539/tumblr_inline_ojmd1xukfv1ta78fg_540.png",alt:null}))),Object(n.b)("h5",null,"Bayesian deep nets provide greater insight into the uncertainty around predicted values at a given point. Read more ",Object(n.b)("a",Object(i.a)({parentName:"h5"},{href:"http://pymc-devs.github.io/pymc3/notebooks/bayesian_neural_network_advi.html"}),"here"),"."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"What books, papers, and people have had the greatest influence on you and your career?")),Object(n.b)("p",null,"I love Dan Simmons’ ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Hyperion_Cantos"}),"Hyperion Cantos")," series, which got me hooked on science fiction. ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://ski.cog.brown.edu/"}),"Michael Frank")," (my PhD advisor) and ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://www.ejwagenmakers.com/"}),"EJ Wagenmakers")," first introduced me to Bayesian statistics. The ",Object(n.b)("a",Object(i.a)({parentName:"p"},{href:"http://mc-stan.org/"}),"Stan guys"),", who developed the NUTS sampler and black-box variational inference, have had a huge influence on PyMC3. They continue to push the boundaries of applied Bayesian statistics. I also really like the work coming out of the labs of David Blei and Max Welling. We hope that PyMC3 will also be an influential tool on the productivity and capabilities on data scientists across the world."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"How do you think data and AI will change the financial services industry over the next few years? What should all hedge fund managers know?")),Object(n.b)("p",null,"I think it’s already had a big impact on finance! And as the mountains of data continue to grow, so will the advantage computers have over humans in their ability to combine and extract information out of that data. Data scientists, with their ability to pull that data together and build the predictive models will be the center of attention. That is really at the core of what we’re doing at Quantopian. We believe that by giving people everywhere on earth a platform that’s state-of-the-art for free we can find that talent before anyone else can."))}l.isMDXComponent=!0},uBpe:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2017-01-11-thomas-wiecki-on-probabilistic-programming-with",function(){var e=a("EMYU");return{page:e.default||e}}])}},[["uBpe","5d41","9da1"]]]);