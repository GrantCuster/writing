(window.webpackJsonp=window.webpackJsonp||[]).push([["34a0"],{"HJ/u":function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/2015-12-09-fashion-goes-deep-data-science-at-lyst",function(){var e=a("uTno");return{page:e.default||e}}])},uTno:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",function(){return s}),a.d(t,"default",function(){return c});var n=a("kOwS"),o=a("qNsG"),i=(a("q1tI"),a("E/Ix")),s={title:"Fashion Goes Deep: Data Science at Lyst",date:new Date("2015-12-09T17:44:00.000Z"),tags:["interview","fashtech","retailtech","data science","deep learning"],layout:"post",post_type:"interview",redirect_from:["/post/134864862628/fashion-goes-deep-data-science-at-lyst"],preview_image:"http://68.media.tumblr.com/993f6c53159f5715d9c127b790bb4bf5/tumblr_inline_nz3b9rPB5w1ta78fg_540.png",interview_with:"Eddie Bell",interview_with_link:"https://twitter.com/ejlbell"},r={frontMatter:s},l="wrapper";function c(e){var t=e.components,a=Object(o.a)(e,["components"]);return Object(i.b)(l,Object(n.a)({},r,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,Object(i.b)("img",Object(n.a)({parentName:"p"},{src:"http://68.media.tumblr.com/993f6c53159f5715d9c127b790bb4bf5/tumblr_inline_nz3b9rPB5w1ta78fg_540.png",alt:null}))),Object(i.b)("p",null,Object(i.b)("p",null,"On November 16, 2015, Lyst, an online fashion marketplace based in the United Kingdom, ",Object(i.b)("a",{href:"https://www.linkedin.com/pulse/lyst-ad-campaign-fashion-meets-data-science-flavia-young"},"launched its first advertising campaign"),". Featuring a series of ironic headlines (one simply says “Rip-off”) etched over beautiful images, the campaign emphasizes the company’s identity as a “challenger brand,” whose success “has been driven by marrying insights from data science with the emotional nature of fashion.” (CEO Chris Morton) "),Object(i.b)("p",null,Object(i.b)("a",{href:"http://www.lyst.com"},"Lyst")," provides fashion consumers with a central platform where they can mix and match millions of products from 11,500 different brands. In this context, data science serves as a virtual personal shopper, recommending products to users based upon insights from their behavior using the site. One might think these recommendations are powered by ",Object(i.b)("a",{href:"https://en.wikipedia.org/wiki/Collaborative_filtering"},"collaborative filtering"),", but the world of fashion is far too transient and fickle to support data models matching similar users. Matrices are sparse and inventory drains rapidly (consider flash sales sites like ",Object(i.b)("a",{href:"http://www.gilt.com/"},"Gilt"),"). Instead, recommendation algorithms align consumer behavior with product features. And as the world of fashion is one dominated by image and appearance, fashion data science has a lot to do with image analysis. "),Object(i.b)("p",null,"We interviewed ",Object(i.b)("a",{href:"https://twitter.com/ejlbell"},"Eddie Bell"),", Lyst’s lead data scientist, about his team’s current efforts to use deep learning to analyze images and personalize recommendations to consumers. We talked about his past, his team’s present, and the fashion industry’s future. "),Object(i.b)("p",null,Object(i.b)("b",null,"What is Lyst and what is its business model? ")),Object(i.b)("p",null,"Lyst is a London-based online fashion marketplace similar to companies like ",Object(i.b)("a",{href:"http://www.asos.com/?hrd=1"},"Asos")," or ",Object(i.b)("a",{href:"http://www.net-a-porter.com/"},"Net-A-Porter"),". We don’t own any fashion products ourselves, but resell them on behalf of affiliated brands and retailers. We actually started off as a purely affiliate marketplace, where retailers rewarded us for driving web traffic to their sites. We scraped the web for semi-structured information about fashion products and then applied machine learning to present this information cleanly and elegantly for consumers from one central website. To make this experience more seamless, we eventually added an our own online checkout system where users could build a look combining different brands and then purchase everything directly from Lyst. We then send transaction information to individual retailers for shipping. "),Object(i.b)("p",null,Object(i.b)("b",null,"What’s your background and how did you end up working in fashion? ")),Object(i.b)("p",null,"I studied machine learning and pure mathematics in graduate school, but was always drawn to applied and practical problems, to the possibility of building systems that seemed like magic to end users. I started my career working on financial trading systems, but was intrigued by the creativity of working with image data, which comprises the bulk of data we work with in the fashion and retail space. I’ve been at Lyst for the past three years. "),Object(i.b)("p",null,Object(i.b)("b",null,"How does your data team provide personalized product recommendations to Lyst users? ")),Object(i.b)("p",null,"We started off with a collaborative filtering approach, basing recommendations to given user on items liked and purchased by similar users in the past. Unfortunately, this didn’t work well for our data set. As Lyst sells 11 million items that constantly go in and out of stock, our item-user interaction matrix wasn’t ",Object(i.b)("a",{href:"https://en.wikipedia.org/wiki/Sparse_matrix"},"dense")," (i.e. where most elements are nonzero) and we could never be sure that a given item would be available for the next user. "),Object(i.b)("p",null,"So we needed a better approach. My colleague ",Object(i.b)("a",{href:"https://twitter.com/Maciej_Kula"},"Maciej Kula")," lead research and engineering efforts to build a new recommendation model called ",Object(i.b)("a",{href:"https://github.com/lyst/lightfm"},"LightFM")," that incorporates item and user metadata into a matrix factorization algorithm. LightFM represents each user and item as the sum of the latent representations of their features, allowing recommendations to generalize to new items (via item features) and to new users (via user features). If a registered Lyst user likes ten items with certain features, we recommend other items with similar features. "),Object(i.b)("p",null,"We also modulate the frequency and density of recommendations to match user engagement with the site. For example, if a user signs in and looks at three different styles of Wellington boots, we’ll serve up multiple images of similar boots during that browsing session and quickly decay the frequency in future sessions.")),Object(i.b)("p",null,Object(i.b)("img",Object(n.a)({parentName:"p"},{src:"http://68.media.tumblr.com/3b6ba56945b0ef2e336b1e1c2592ae8b/tumblr_inline_nz3ehxLPGZ1ta78fg_540.png",alt:null}))),Object(i.b)("p",null,Object(i.b)("p",null,Object(i.b)("b",null,"What about recommendations for consumers who don’t have a registered Lyst account?")),Object(i.b)("p",null,"We deal with this often given traffic to our site from Google advertisements or search results. Demographic segmentation across brands gives us a good place to start: if a user lands on a Gucci bag, we have a general idea that he or she is interested in luxury products, so we won’t show Zara street wear. Ultimately, however, the value of this social, demographic segmentation is limited. Someone who likes Gucci bags may prefer Prada dresses and Jimmy Choo shoes – one key value at Lyst is that we can aggregate recommendations to curate taste across different brands. "),Object(i.b)("p",null,Object(i.b)("b",null,"What machine learning techniques do you use to recognize features in fashion product images? ")),Object(i.b)("p",null,"One of the key challenges in image processing for fashion is to recognize duplicates of the same item, as you don’t want to serve multiple images of the same product in different contexts (one Gucci dress on or off the model) or colors (a Uniqlo shirt in white, black, or orange) to the same user. Old school visual processing techniques analyzed images to look for areas of gradient change, which often correlated with product features. The algorithms converted points of interest into a vector, and we compared vectors from different images to find matches to signal duplicates. For example, we could match a picture of a woman wearing an earring with an image of that earring on a blank background. This approach worked for certain stark patterns or shapes, but didn’t perform well with features like the local texture of a pair of blue jeans. They were also entirely ",Object(i.b)("a",{href:"https://www.coursera.org/learn/machine-learning/lecture/olRZo/unsupervised-learning"},"unsupervised"),", so we couldn’t fine tune them. "),Object(i.b)("p",null,Object(i.b)("b",null,"That was the old school approach. Have you started using deep learning methods for image analysis?  ")),Object(i.b)("p",null,"We’re actually in the process of training the Lyst ",Object(i.b)("a",{href:"http://colah.github.io/posts/2014-07-Conv-Nets-Modular/"},"convolutional neural network")," now, and predict it will provide a massive boost in accuracy and performance on feature detection and product duplicate identification. Employing ",Object(i.b)("a",{href:"http://www.mathworks.com/help/stats/supervised-learning-machine-learning-workflow-and-algorithms.html"},"supervised")," learning, we’re training the deep representation model on 5 million labeled images and fine tuning the network to boost accuracy. Our labeling team combines workers from Amazon’s ",Object(i.b)("a",{href:"https://www.mturk.com/mturk/welcome"},"Mechanical Turk"),", remote contract moderators, and internal full-time moderators. We have a consensus process whereby each moderator gets a score proportional to their agreement with other moderators. The higher a score a moderator has, the more weight he/she has. At Lyst, we have a lot of models that use the ",Object(i.b)("a",{href:"https://medium.com/the-wtf-economy/artificial-intelligence-and-the-future-of-work-a0eaabea7c41%22%20%5Cl%20%22.xc7zgmslj"},"human-in-the-loop")," methodology. Ultimately, our consensus process becomes encoded as intelligence in the model and we need fewer moderators to have confident labels. "),Object(i.b)("p",null,"We are building a network that has one “deep” representation of each product, metaphorically the network’s master concept of a given product. Like a natural language concept, we need a many-to-one as opposed to a one-to-one relationship between images and representations. Take a Gucci dress as an example. The Lyst data set may have an image of the dress on the hanger in the store, on the runway, on a static model, on people on the streets, or even written product descriptions of varying length. We want to use all this data to create one representation: “Gucci dress.” "),Object(i.b)("p",null,Object(i.b)("b",null,"What’s one challenge you’ve encountered while building your deep learning model and how did you address it?  ")),Object(i.b)("p",null,"One challenge is that we have different quantities of text and image data for different items. To address this, we found additional fashion data from the internet, and are playing with the idea of synthetically generating labeled data to train our network. This hack was inspired by talks I saw at the 2015 ",Object(i.b)("a",{href:"http://www.iclr.cc/doku.php"},"ICLR")," (the International Conference on Learning Representations) in San Diego. As it can be cost prohibitive for small research groups to acquire data sets with millions of labeled images, people have started to synthetically increase the size of their data sets through multisampling (where each image is cropped in multiple ways, or flipped horizontally and vertically) or introducing noise into the input every time a piece of data is shown to the network (which improves performance on rotated or zoomed in images). "),Object(i.b)("p",null,"Another technique we’re using to improve duplicate detection is called a region-based convolutional neural network, or ",Object(i.b)("a",{href:"https://github.com/rbg"},"R-CNN"),". We try to estimate bounding boxes around items or features in images to isolate garments or parts of items instead of looking at the images globally. "),Object(i.b)("p",null,Object(i.b)("b",null,"When we built "),Object(i.b)("a",{href:"http://pictograph.us"},Object(i.b)("b",null,"Pictograph")),Object(i.b)("b",null,", our deep learning prototype, we chose to "),Object(i.b)("a",{href:"http://blog.fastforwardlabs.com/2015/11/17/when-dog-is-enough-using-hypernyms-to-improve.html"},Object(i.b)("b",null,"manage low confidence labels")),Object(i.b)("b",null," by leveraging semantic relationships in WordNet, which is the backbone for ImageNet. Are you employing anything similar to manage low confidence labels in your network? ")),Object(i.b)("p",null,"Yes, we do use analogous techniques. We have a fashion ontology affiliated with the Lyst network. This forms a semantic tree with men and women at the top of the tree, followed by item types (e.g. shirts, shoes, or jewelry) as branches, and specific items  (e.g. leather wedge sandals) as leaves. The network is trained on each individual, specific level as well as the full path through the tree. So if there is low confidence in classifying an item as “leather wedge sandal,” there may be higher confidence in saying it’s a ladies shoe, not a men’s suit. Our human in the loop consensus method also helps train the network across these semantic lines. "),Object(i.b)("p",null,Object(i.b)("b",null,"What will the fashion industry will look like in the future? ")),Object(i.b)("p",null,"The key question is whether traditional retailers will ",Object(i.b)("a",{href:"http://blog.fastforwardlabs.com/2015/08/19/machine-learning-applications-in-fashion-retail.html"},"incorporate technology into operations and strategy")," or derive value from data and technologies through partnerships with companies like Lyst. Our partnership team is working hard to educate high-end, traditional brands of the value modern data science techniques can provide to their business. A key obstacle is their fear that they would lose control over their branding strategy: a high-end retailer like Prada doesn’t want its image mixed up with H","&","M or Zara on a central platform like Lyst. But we’ve seen tremendous adoption by consumers who like to have their own control to mix and match products and create their own look. With capabilities like deep learning really taking off, we’re excited to see what comes next!")))}c.isMDXComponent=!0}},[["HJ/u","5d41","9da1"]]]);