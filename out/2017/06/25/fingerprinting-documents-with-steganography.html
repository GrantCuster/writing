<!DOCTYPE html><html><head><link rel="preload" href="/static/fonts/Inter-Regular.woff2?v=3.5" as="font" type="font/woff2" crossorigin="*"/><link rel="preload" href="/static/fonts/Inter-Italic.woff2?v=3.5" as="font" type="font/woff2" crossorigin="*"/><link href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" rel="stylesheet"/><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" class="next-head"/><meta charSet="utf-8" class="next-head"/><style class="next-head">.js-no-flash { display: none }</style><noscript class="jsx-4059783939 jsx-3344216300 next-head"><style>.js-no-flash { display: block }</style></noscript><link rel="icon" type="image/x-icon" href="static/images/favicon.png" class="jsx-1135431938 jsx-2959859206 next-head"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous" class="jsx-1135431938 jsx-2959859206 next-head"/><title class="jsx-1135431938 jsx-2959859206 next-head">F⁠ingerprinting documents​ with steganography​ - Cloudera Fast Forward</title><link rel="preload" href="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/posts/2017-06-25-fingerprinting-documents-with-steganography.js" as="script"/><link rel="preload" href="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-fdce77a122c11e06ae50.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.f77b50de979bfbbb280b.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-5ab107747766f1b4e0bf.js" as="script"/><style id="__jsx-4059783939">@font-face{font-family:'Inter';font-style:normal;font-weight:400;src:url('/static/fonts/Inter-Regular.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-Regular.woff?v=3.5') format('woff');}@font-face{font-family:'Inter';font-style:italic;font-weight:400;src:url('/static/fonts/Inter-Italic.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-Italic.woff?v=3.5') format('woff');}@font-face{font-family:'Inter';font-style:normal;font-weight:700;src:url('/static/fonts/Inter-Bold.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-Bold.woff?v=3.5') format('woff');}@font-face{font-family:'Inter';font-style:italic;font-weight:700;src:url('/static/fonts/Inter-BoldItalic.woff2?v=3.5') format('woff2'), url('/static/fonts/Inter-BoldItalic.woff?v=3.5') format('woff');}*{box-sizing:border-box;}html{font-family:'Inter',serif;font-size:18px;line-height:27px;text-rendering:optimizelegibility;font-feature-settings:'kern';font-kerning:normal;font-feature-settings:'ss02' 1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}pre{-webkit-font-smoothing:auto;-moz-osx-font-smoothing:auto;overflow-x:auto;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo, Monaco,Courier New,monospace;}body{margin:0;overflow-x:hidden;}a{color:inherit;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:opacity 0.025s linear;transition:opacity 0.025s linear;}a:hover{opacity:0.75;}a.no-hover:hover{opacity:1;}.hover_box_overlay{opacity:0;-webkit-transition:opacity 0.025s linear;transition:opacity 0.025s linear;}.hover_box:hover .hover_box_overlay{opacity:1;}a.gray-backer{-webkit-transition:background 0.05s linear;transition:background 0.05s linear;}a.gray-backer:hover{background:#f3f3f3;}button:focus{outline:#999 auto 3px;}</style><style id="__jsx-3344216300">html{font-size:17.189999999999998px;line-height:25.784999999999997px;}a,.display-link{background-image:linear-gradient( to right, black 100%, transparent 0% );background-position:0em calc(1.07em);background-repeat:repeat-x;background-size:1em 0.07em;}a.no-underline{background-image:none;}a.no-hover{background-image:none;}a.no-hover:hover{background-image:none;opacity:1;}</style><style id="__jsx-2959859206">h1,h2,h3,h4,h5,h6{font-weight:400;font-style:normal;margin:0;}h1{font-size:51.56999999999999px;line-height:1.25;}h2{font-size:34.379999999999995px;line-height:1.25;padding-top:25.784999999999997px;margin-bottom:25.784999999999997px;}h3{font-size:25.784999999999997px;line-height:1.25;padding-top:25.784999999999997px;margin-bottom:25.784999999999997px;}h4{font-size:21.487499999999997px;line-height:1.25;padding-top:0px;margin-bottom:25.784999999999997px;}h5{font-size:12.892499999999998px;line-height:1.4375;margin-bottom:12.892499999999998px;padding-bottom:12.892499999999998px;margin-top:-12.892499999999998px;}p{margin:0 0 25.784999999999997px 0;}ol,ul{margin:0 0 25.784999999999997px 0;padding-left:25.784999999999997px;}blockquote{margin:0 0 25.784999999999997px 25.784999999999997px;}.html-video-holder{margin:0 0 25.784999999999997px 0;}video{max-width:100%;}code{background:#eaeaea;padding-right:3px;padding-left:3px;font-size:0.975em;word-break:break-word;}</style><style id="__jsx-1135431938">code[class*='language-'],pre[class*='language-']{color:black;background:none;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono', monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}pre[class*='language-']::-moz-selection,pre[class*='language-']::-moz-selection,code[class*='language-']::-moz-selection,code[class*='language-']::-moz-selection{text-shadow:none;}pre[class*='language-']::selection,pre[class*='language-']::selection,code[class*='language-']::selection,code[class*='language-']::selection{text-shadow:none;}@media print{code[class*='language-'],pre[class*='language-']{text-shadow:none;}}:not(pre)>code[class*='language-']{white-space:normal;}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:slategray;}.token.punctuation{color:#999;}.namespace{opacity:0.7;}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905;}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690;}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#9a6e3a;}.token.atrule,.token.attr-value,.token.keyword{color:#07a;}.token.function,.token.class-name{color:#dd4a68;}.token.regex,.token.important,.token.variable{color:#e90;}.token.important,.token.bold{font-weight:bold;}.token.italic{font-style:italic;}.token.entity{cursor:help;}</style></head><body><div id="__next"><div class="jsx-4059783939 jsx-3344216300 js-no-flash"><div style="padding-bottom:12.892499999999998px"><div style="position:relative"><div style="position:relative;padding:6.446249999999999px 12.892499999999998px 6.446249999999999px 12.892499999999998px;background-image:url(&quot;/static/images/dataline.png&quot;)"><div style="display:flex;justify-content:space-between"><div style="display:flex;align-items:center;height:25.784999999999997px;padding-top:1px"><a href="https://www.cloudera.com/products/fast-forward-labs-research.html" style="display:block;line-height:0" class="no-underline no-hover"><img style="height:12.892499999999998px" src="/static/images/cloudera.png"/></a></div><div style="display:flex;align-items:center;padding-top:1px;font-size:17.189999999999998px;line-height:1.5"><a class="no-underline" href="https://www.cloudera.com/products/fast-forward-labs-research.html" style="color:#333e47;font-size:12.892499999999998px;line-height:1.5">About Us →</a></div></div><div style="position:absolute;left:0;width:100%;height:2px;transform:scaleY(0.60165);transform-origin:center center;background:rgba(0,0,0,0.125);bottom:-1px"></div></div><div style="padding:12.892499999999998px 12.892499999999998px 12.892499999999998px 12.892499999999998px;display:flex;justify-content:space-between;font-size:17.189999999999998px;line-height:1.5"><div style="display:flex;align-items:center"><a class="no-hover no-underline" style="display:flex;align-items:center" href="/"><img style="height:18.75272727272727px;width:18.75272727272727px;margin-right:9.669374999999999px;position:relative;top:-0.5860227272727272px" src="/static/images/ff.png"/><div>Fast Forward Labs </div></a></div><div style="display:flex;align-items:center;height:25.784999999999997px"></div><div style="display:flex"><div style="margin-right:12.892499999999998px"><a href="/">Blog</a></div><div><a href="https://experiments.fastforwardlabs.com">AI Experiments</a></div></div></div><div style="position:absolute;left:0;width:100%;height:2px;transform:scaleY(0.60165);transform-origin:center center;background:black;bottom:-1px"></div></div></div><div class="jsx-1135431938 jsx-2959859206"><div style="position:relative" class="jsx-1135431938 jsx-2959859206"><div style="padding-left:6.446249999999999px;padding-right:6.446249999999999px;padding-top:25.784999999999997px" class="jsx-1135431938 jsx-2959859206"><div class="jsx-1135431938 jsx-2959859206"><div style="display:flex;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206"><div style="width:293.55375px;padding:0px 12.892499999999998px;position:relative;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1" class="jsx-1135431938 jsx-2959859206">Jun 06 2017</div><div style="width:293.55375px;padding:0px 12.892499999999998px;position:relative;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1" class="jsx-1135431938 jsx-2959859206">post</div></div><div style="margin-bottom:0" class="jsx-1135431938 jsx-2959859206"><div style="font-size:42.974999999999994px;line-height:1.25;padding:0px 12.892499999999998px;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206">F⁠ingerprinting documents​ with steganography​</div></div><div style="display:flex;flex-wrap:wrap;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206"><div style="padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px;width:587.1075px" class="jsx-1135431938 jsx-2959859206"><div class="jsx-1135431938 jsx-2959859206">by<!-- --> <a href="https://github.com/n-s-f" class="jsx-1135431938 jsx-2959859206">Noam</a></div></div><div style="width:587.1075px;padding:25.784999999999997px 12.892499999999998px 25.784999999999997px 12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><p>Steganography is the​ practice​ of​ hiding messages​ anywhere​ they’re​ not expected‏‎.
I⁠n a well-executed​ piece of​ steganography, anyone who​ is​ not the intended​
recipient can​ look at​ the​ message​ and not​ realize its there at all‏‎. In a recent
headline-making
<a href="http://www.bbc.com/future/story/20170607-why-printers-add-secret-tracking-dots">story</a>,
The I⁠ntercept inadvertently outed​ their​ source​ by publishing​ a document with​ an
embedded steganographic​ message that allowed​ the NSA to identify the​ person​ who
printed it‏‎.</p><p><div style="position:relative"><img src="/static/images/2017/06/stego_images.jpg" style="display:block;margin:0;width:100%"/></div></p><p>These days, information is​ often​ hidden​ in digital media​ like images and​ audio​
files, where flipping a few bits​ doesn’t change​ the​ file to​ the​ human​ eye (or
ear)‏‎. B⁠efore computers​ came along, though, there​ were​ plenty of messages​
creatively hidden in art, furniture, etc. There’s speculation​ that​ women in​ the​
U.S⁠. used to​ hide​ messages​ in​ their quilt work​ as a way​ to help escaped slaves
find friendly homes‏‎. Neal S⁠tephenson​ riffs​ on​ this theme​ in​ his​ Quicksilver​
T⁠rilogy by having​ E⁠liza embed a binary code​ in her​ cross-stitching​ to smuggle​
information​ out of the court​ of​ L⁠ouis X⁠IV.</p><p>Hiding​ messages​ in text​ has always been​ especially challenging‏‎. T⁠here’s not​ much​
room​ to make changes​ without​ fundamentally altering the​ meaning of​ the original
document, which​ in turn makes​ it​ obvious​ that something is​ amiss. If someone
other than the​ intended​ recipient​ of the​ information realizes that there’s​ a​
message present​ at​ all, the​ steganography​ has, in some sense, failed‏‎.</p><h2>What problem are we trying to​ solve?</h2><p>In this post, I’ll talk about fingerprinting​ documents​ using text-based
steganography‏‎. T⁠he problem we’re​ trying​ to solve is as follows‏‎. We​ have​ a​
sensitive document that​ must​ be distributed​ to​ some​ number of​ readers. Let’s
say, for​ example, that​ Grandpa has​ decided​ to share his​ famous​ cookie recipe​
with​ each​ of​ his grandchildren‏‎. B⁠ut​ it’s super important​ to him that​ the​ recipe​
stays in​ the​ family! S⁠o they’re​ not​ allowed to share it with​ anyone else‏‎. I⁠f​
Grandpa finds​ pieces of his​ cookie​ recipe online later, he​ wants to know which​
grandchild​ broke the​ family​ trust.</p><p>To address​ this​ problem, he assigns each of his​ grandchildren an​ I⁠D, which is
just​ a string of​ zeros​ and​ ones. Before​ he​ gives out the​ recipe, he identifies a
number of ’branchpoints’ in the​ text‏‎. These are​ places​ where he can​ make​ a
change​ without​ altering​ the​ grandchild’s experience​ of​ the​ recipe, or alerting
them​ that something is amiss‏‎. One such branch point might be​ spelling​ out​ the​
numbers in the​ recipe - “ten​ ”instead​ of “10”‏‎. A⁠nother​ might​ be using​ imperial​
units​ instead of​ metric. T⁠his type​ of​ method​ is called a​ <a href="https://en.wikipedia.org/wiki/Canary_trap">canary
trap</a>.</p><p>For each grandchild, he​ goes through the branchpoints one at a​ time‏‎. I⁠f the
grandchild’s ID has​ a​ zero​ at some position, he​ does not make​ a​ change at​ the
corresponding branch​ point. I⁠f​ it​ is​ a one, he​ makes the change‏‎.</p><p>N⁠ow, by looking at​ which changes​ had been made​ in the leaked cookie recipe, he​
should be​ able to​ identify which​ grandchild was the source​ of​ the​ leak.</p><p>H⁠ow​ does​ he find​ all​ the branchpoints he​ can use​ to effectively​ fingerprint​
the recipe?</p><p>Before​ we can​ answer that​ question, we’ll​ have​ to take​ a slight detour into the​
world of character encoding.</p><h2>Digital character​ encoding</h2><p>Computers​ think​ in​ binary, so when​ they save any​ symbol you might​ consider to be​
text, what they’re actually saving is some string​ of​ zeros and ones‏‎. The map
that​ converts​ between​ binary and symbols​ is called a​ character​ encoding.</p><p>For a long​ time, the dominant​ character​ encoding
was​ <a href="http://www.asciitable.com/">ASCII</a>, which​ can​ only encode 256 characters‏‎.
T⁠hese include​ upper and​ lower​ case English​ letters, numbers, and some
punctuation.</p><p>A couple of decades​ ago, some​ folks got​ together​ and decided​ this wasn’t​ good​
enough, not​ least​ because people who​ don’t speak E⁠nglish should be able to use
computers‏‎. They developed​ a​ specification​ called​ <a href="http://unicode.org/">unicode</a>
that now​ includes​ over​ 120,000 different characters​ and​ has the capacity​ to​
expand to over one million‏‎.</p><p>Fortunately​ for​ us, there’s more​ room​ for hiding information these​ days​ than​
there used​ to be. We’ll​ see​ how we​ can take advantage​ of all​ those​ extra
characters​ to​ find​ branchpoints in any​ document‏‎.</p><h3>Identifying branchpoints​</h3><p>Some​ Unicode characters​ are more obviously​ useful​ than​ others. Take, for​
instance, the <a href="https://codepoints.net/U+200B">zero width space</a>. It has some
semantic significance​ - it​ tells​ whatever is​ rendering the text that​ it’s​ okay
to​ put​ a​ line​ break somewhere, even if​ there’s no other whitespace character.
For​ example, it will sometimes be used after a slash​ - it’s​ okay to start​ a​ new
line after​ a​ slash, but if you don’t, there shouldn’t​ be a​ visible​ space‏‎.</p><p>So​ what​ happens​ if​ you​ put​ one​
of​ those​ zero​-​width​ spaces​ right​
in​ front​ of​ a​ normal,​ every​ day​
space?​ Absolutely​ nothing.​ I⁠t​ conveys​ no​
extra​ information,​ and​ doesn’t​ visibly​
change​ the​ text​ document​ at​ all.​ I⁠n​
fact,​ there’s​ a​ zero-width​ space​ in​
front​ of​ every​ space​ in​ this​
paragraph.​ Bet​ you​ couldn’t​ tell‏‎.</p><p>T⁠his​ means we​ can already treat every​ normal​ single space as​ a​ branch point,
where we​ can​ choose whether​ or​ not​ to​ place a​ zero​ width​ space in front​ of it.
D⁠epending​ on​ how much​ information​ you’re​ trying to​ encode, this​ may or may not
be​ a good​ idea‏‎.</p><p>T⁠here are a​ number of other​ non-displaying​ characters that we​ could use in a​
similar​ way, but let’s​ move​ on to characters we​ can​ actually see.</p><p>When you​ have 120,000 characters, some​ of​ them are bound to​ look the same‏‎.
H⁠ere’s​ an <a href="https://codepoints.net/U+0041">English character</a> A, and​ here’s​ a
<a href="https://codepoints.net/U+0391">Greek character</a> Α. S⁠ee the difference?</p><p><div style="position:relative"><img src="/static/images/2017/06/confusables.png" style="display:block;margin:0;width:100%"/></div></p><p>Similar characters like these, called​ ’confusables’, are​ recognized as being​
dangerous​ enough that all​ modern​ browsers often​ some​ protection​ against​ letting
you​ visit​ spoofed​ urls. Think​ you’re going to www.yahoo.com​ (all english
characters)? Well, you may end up​ at​ ԝԝԝ.𝐲𝖺𝗵օօ.сօⅿ (no​ english​ characters) if
you’re not​ careful.</p><p>H⁠ere’s​ a great​ unicode​
<a href="http://unicode.org/cldr/utility/confusables.jsp?a=fast+forward+labs&amp;r=None">resource</a>
for​ identifying​ confusables.</p><p><div style="position:relative"><img src="/static/images/2017/06/unicode_url.png" style="display:block;margin:0;width:100%"/></div></p><p>U⁠sed​ judiciously, there​ are plenty​ of confusables​ that are, well, suitably​
confusing‏‎. H⁠ere are a​ few rules of thumb: simpler​ letters are more easily
confused. For​ example, generally​ l-shaped​ things look more like each other​ than​
g-shaped​ things. Standalone, one​ letter words are​ harder​ to spot​ because they
are​ separated by​ their​ neighbors​ by​ spaces, and so​ you don’t automatically​
visually​ juxtapose them with​ other characters‏‎. And, finally, how convincing​ your
confusables are will depend​ to some​ degree on​ the font‏‎. Some typefaces may​
magnify​ the​ differences between​ confusables, while​ others​ will render​
confusables​ as more similar​ to each​ other. U⁠ltimately, you​ don’t want to​ change
your​ readers’ experience of​ the​ text​ in any​ way, so it’s good to be​ careful with
these.</p><p>But using funny characters​ in unicode is​ sometimes​ dangerous‏‎. In​ particular, if
an unintended​ recipient of the​ message copies the​ text into an ASCI⁠I⁠-only
editor, it won’t​ know what to make​ of​ those​ crazy unicode characters​ and they’ll
probably​ just​ show up as ????????, which is​ a pretty​ good​ hint to​ the​ interloper​
that something strange​ is​ going on‏‎.</p><p>In​ the​ ASC⁠II-only world, your options are much​ more​ limited. I⁠n​ general, though,
any time​ you make​ a​ stylistic​ decision​ that could go​ either way, you can​
consider that to be a branch point‏‎. For example, do​ you​ use​ single​ quotes or​
double​ quotes? D⁠o you​ spell​ out numbers, or do​ you​ use the numeric
representations? If​ you want​ to​ be consistent​ throughout​ your document, each of
these​ decisions​ will​ only get​ you one bit of​ hidden​ information. B⁠ecause you
have​ fewer options, you’ll​ have​ to get​ more​ creative‏‎.</p><p>For example, we​ put​ five branchpoints in​ the following​ to produce a​ 5-bit message:</p><ul><li>Ralphie​ set​ his​ secret decoder ring​ to “B ”and “twelve ”to decode the​ message‏‎.
I⁠t said, “B⁠e sure to drink​ your​ Ovaltine”‏‎. (00000)  </li><li>R⁠alphie​ set​ his secret decoder​ ring to ’B’ and ’twelve’ to decode the​ message.
It said, “Be sure to drink​ your​ Ovaltine”. (10000)  </li><li>R⁠alphie​ set his secret​ decoder​ ring to “B ”and “12 ”to​ decode the​ message‏‎. I⁠t
said, “Be​ sure​ to drink​ your​ O⁠valtine”. (01000)  </li><li>R⁠alphie set his secret​ decoder​ ring to “B​ ”and​ “twelve ”to decode​ the​ message.
I⁠t​ said​ “B⁠e sure​ to​ drink​ your Ovaltine”‏‎. (00100)  </li><li>Ralphie set​ his​ secret​ decoder ring​ to​ “B​ ”and “twelve​ ”to​ decode the message.
It​ said, ’Be​ sure​ to​ drink your O⁠valtine’. (00010)  </li><li>Ralphie​ set​ his secret decoder​ ring to “B ”and​ “twelve​ ”to decode​ the​ message.
It said, “be​ sure​ to drink your Ovaltine”‏‎. (00001)  </li><li>Ralphie​ set​ his secret decoder ring​ to ’B’ and​ ’12’ to​ decode​ the message. I⁠t​
said ’be sure​ to drink your Ovaltine’. (11111)</li></ul><h2>Introducing: S⁠teganos​</h2><p>In order​ to​ play around with​ these​ concepts, we created​ a​ tool​ called​
<a href="http://github.com/fastforwardlabs/steganos">steganos</a>. Steganos​ is​ packaged​
with a small​ library of branchpoints (pull​ requests for new branchpoints are
welcome!) and has​ the​ ability​ to: calculate​ the number of​ encodable bits,
encode/decode​ bits​ into text​ and​ do​ a​ partial recovery​ of​ bits​ from text​
snippets. A⁠ll this​ is​ possible​ by tracking the​ original unadulterated text as​
well as which branchpoints were available to​ steganos​ when​ the message was
encoded.</p><p>As​ an​ example, using​ the <a href="http://github.com/fastforwardlabs/steganos%5D">current
version</a> of steganos, we​
can encode 1756 bits​ into​ this text‏‎. If we​ are using​ this​ for​ user-identification​
and expect​ to always see​ leaks​ of the full​ document, that means​ we can track​
10^529 users (ie: vastly more than the​ number of​ people who​ have ever​ existed).</p><div><div style="position:relative;margin-bottom:25.784999999999997px;width:602px;margin-left:-20.338749999999997px;margin-right:-20.338749999999997px"><div class="prism-code language-python" style="overflow-x:auto;overflow-y:hidden;background:#f3f3f3"><pre style="float:left;font-size:12.892499999999998px;min-width:100%;position:relative;line-height:1.5;margin:0;padding:12.892499999999998px;overflow:visible"><div class="token-line"><span><span class="token keyword">import</span><span class="token plain"> steganos</span></span></div><div class="token-line"><span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">message </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;101&#x27;</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">original_text </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string">&#x27;”Wow! ”they said.\n\t”This tool is really #1”&#x27;</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">capacity </span><span class="token operator">=</span><span class="token plain"> steganos</span><span class="token punctuation">.</span><span class="token plain">bit_capacity</span><span class="token punctuation">(</span><span class="token plain">original_text</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token comment"># == 10</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">encoded_text </span><span class="token operator">=</span><span class="token plain"> steganos</span><span class="token punctuation">.</span><span class="token plain">encode</span><span class="token punctuation">(</span><span class="token plain">message</span><span class="token punctuation">,</span><span class="token plain"> original_text</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">recovered_bits </span><span class="token operator">=</span><span class="token plain"> steganos</span><span class="token punctuation">.</span><span class="token plain">decode_full_text</span><span class="token punctuation">(</span><span class="token plain">encoded_text</span><span class="token punctuation">,</span><span class="token plain"> original_text</span><span class="token punctuation">,</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">                                           message_bits</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span><span class="token comment"># recovered_bits == &#x27;101&#x27;</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">partial_text </span><span class="token operator">=</span><span class="token plain"> encoded_text</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token plain">  </span><span class="token comment"># only use 18% of the text</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">recovered_bits </span><span class="token operator">=</span><span class="token plain"> steganos</span><span class="token punctuation">.</span><span class="token plain">decode_partial_text</span><span class="token punctuation">(</span><span class="token plain">partial_text</span><span class="token punctuation">,</span><span class="token plain"> original_text</span><span class="token punctuation">,</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain">                                              message_bits</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span><span class="token comment"># recovered_bits == &#x27;1?1&#x27;</span><span class="token plain"></span></span></div><div class="token-line"><span><span class="token plain"></span></span></div></pre><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><p>As an​ example, below​ is​ the opening​ to​ S⁠tar W⁠ars​ with and without​ a message​
hidden inside​ of​ it. Do​ you know​ which is​ the​ original?</p><div><div style="position:relative;margin-bottom:25.784999999999997px;width:602px;margin-left:-20.338749999999997px;margin-right:-20.338749999999997px"><div class="prism-code language-" style="overflow-x:auto;overflow-y:hidden;background:#f3f3f3"><pre style="float:left;font-size:12.892499999999998px;min-width:100%;position:relative;line-height:1.5;margin:0;padding:12.892499999999998px;overflow:visible"><div class="token-line"><span><span class="token plain">It​ is a period of civil​ war. Rebel​ spaceships, striking​ from​ a hidden base, have​ won their first​ victory​ against the evil​ Galactic​ Empire‏‎.</span></span></div><div class="token-line"><span><span class="token plain">D⁠uring the battle, Rebel spies​ managed to​ steal​ secret plans​ to the​ E⁠mpire’s ultimate​ weapon, the D⁠EA⁠TH ST⁠A⁠R, an​ armored space station with enough​ power​ to destroy an​ entire planet‏‎.</span></span></div><div class="token-line"><span><span class="token plain">Pursued​ by the​ Empire’s sinister​ agents, P⁠rincess L⁠eia​ races​ home aboard​ her starship, custodian of the​ stolen​ plans that can save her​ people and​ restore​ freedom​ to the galaxy‏‎...‏‎.</span></span></div><div class="token-line"><span><span class="token plain"></span></span></div></pre><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><div><div style="position:relative;margin-bottom:25.784999999999997px;width:602px;margin-left:-20.338749999999997px;margin-right:-20.338749999999997px"><div class="prism-code language-" style="overflow-x:auto;overflow-y:hidden;background:#f3f3f3"><pre style="float:left;font-size:12.892499999999998px;min-width:100%;position:relative;line-height:1.5;margin:0;padding:12.892499999999998px;overflow:visible"><div class="token-line"><span><span class="token plain">It is a period of civil war. Rebel spaceships, striking from a hidden base, have won their first victory against the evil Galactic Empire.</span></span></div><div class="token-line"><span><span class="token plain">During the battle, Rebel spies managed to steal secret plans to the Empire’s ultimate weapon, the DEATH STAR, an armored space station with enough power to destroy an entire planet.</span></span></div><div class="token-line"><span><span class="token plain">Pursued by the Empire’s sinister agents, Princess Leia races home aboard her starship, custodian of the stolen plans that can save her people and restore freedom to the galaxy....</span></span></div><div class="token-line"><span><span class="token plain"></span></span></div></pre><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><h2>C⁠onclusion</h2><p>H⁠ere we’ve seen a number​ of tricks we can use to fingerprint each​ individual
copy of​ a​ document, without​ changing the​ reader’s experience or​ alerting them
that​ they have a​ uniquely identifiable copy. There are a​ few​ practical
considerations you’ll​ have to address if​ you​ go​ down this route​ - like how you​
identify​ the user from partial documents, or​ how you​ systematically​ mark pieces​
of​ text​ that cannot​ be​ changed without​ breaking the​ document​ (e.g. urls) - but
these​ are mostly logistical issues.</p><p>Fingerprinting documents​ in​ this way​ can​ be a​ powerful tool​ in​ finding​ out​ who
breached a​ confidentiality agreement. O⁠n the flip side, it can also be​ used to
track​ people’s​ behavior​ in​ ways they​ haven’t​ agreed​ to, which is​ something​ to be
cautious​ of‏‎. There’s a little too​ much of​ that​ going on​ on​ the internet as it​
is‏‎.</p><p>D⁠o you​ have ideas for other​ cool​ branchpoints? Let​ us know!</p><p>– <a href="https://github.com/n-s-f">Noam</a> and <a href="http://github.com/mynameisfiber/">Micha</a></p><p>T⁠hanks to​ <a href="https://twitter.com/MannyMoss">Manny</a> for​ his great​ edits!</p><p>P⁠S⁠: If you​ want​ to make sure​ you <em>aren’t</em> being​ tracked this way, simply​ make
sure you​ only​ copy​ the AS⁠CII transliterated version of text! I⁠n​ some​ systems,
this is​ done by selecting the​ “C⁠opy as​ P⁠lain​ T⁠ext ”option.</p><script type="text/javascript">console.log(&quot;generated with steganos commit hash 5612311deaeefba79621123cf7270f6021f95231&quot;);</script><div style="display:none;justify-content:center;padding:12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><img style="height:18.75272727272727px;width:18.75272727272727px;position:relative;display:block" src="/static/images/ff.png" class="jsx-1135431938 jsx-2959859206"/></div></div></div></div><div style="position:relative;display:block;width:612.8924999999999px;grid-template-columns:repeat(2, 1fr);margin-left:-12.892499999999998px;margin-right:-12.892499999999998px"><div style="display:grid"><div style="position:relative;display:grid;grid-template-rows:auto 1fr;margin-bottom:12.892499999999998px"><div style="text-transform:uppercase;font-size:12.892499999999998px;letter-spacing:0.03em;line-height:1.5;padding-bottom:6.446249999999999px;padding-left:25.784999999999997px">Newer</div><div style="position:relative;display:grid"><a class="hover-box no-underline no-hover gray-backer hover-extend" style="display:block;position:relative;width:612.8925px;padding-left:12.892499999999998px;padding-right:12.892499999999998px;margin-left:0;margin-right:0" href="/2017/07/05/probabilistic-programming-from-scratch.html"><div style="display:flex;flex-wrap:wrap"><div style="display:flex;width:587.1075px;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1.5;margin-left:0"><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>Jul 05 2017</div></div><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>post</div></div></div><div style="position:relative;width:587.1075px;padding:12.892499999999998px 0px"><div style="font-size:34.379999999999995px;line-height:1.25;padding:0px 12.892499999999998px;margin-top:-6.446249999999999px"><div style="padding-left:0">Probabilistic programming from scratch</div></div><div style="padding-top:6.446249999999999px;position:relative"><div style="font-size:15.041249999999998px;line-height:1.5em;display:flex;flex-wrap:wrap;padding-left:0"><div style="padding:0px 12.892499999999998px;width:293.55375px"><div style="height:90.24749999999999px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:4;hyphens:auto;-webkit-box-orient:vertical"><span>by <!-- -->Mike<!-- --> ◦ </span>
This article contains highlights from a series of three interactive video tutorials on probabilistic programming from scratch published on O&#x27;Reilly Safari (login required).

If you&#x27;re interested in the business case for probabilistic programming the Fast Forward Labs report...</div><div style="overflow:hidden;width:100%;text-overflow:ellipsis;white-space:nowrap"><span class="display-link"><span>View<!-- --> <span style="text-transform:lowercase">post</span></span></span></div></div><div style="position:relative;width:293.55375px"><div style="width:calc(100% - 25.784999999999997px);height:calc(100% - 12.892499999999998px);margin-left:12.892499999999998px;margin-top:6.446249999999999px;background-image:url(/static/images/2017/07/output_30_0.png);background-size:contain;background-position:center center;background-repeat:no-repeat"></div></div></div></div></div></div></a><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div><div style="display:grid"><div style="position:relative;display:grid;grid-template-rows:auto 1fr;margin-bottom:12.892499999999998px"><div style="text-transform:uppercase;font-size:12.892499999999998px;letter-spacing:0.03em;line-height:1.5;padding-bottom:6.446249999999999px;padding-left:25.784999999999997px">Older</div><div style="position:relative;display:grid"><a class="hover-box no-underline no-hover gray-backer hover-extend" style="display:block;position:relative;width:612.8925px;padding-left:12.892499999999998px;padding-right:12.892499999999998px;margin-left:0;margin-right:0" href="/2017/06/06/probabilistic-programming-sci-fi-bayeshead-5000.html"><div style="display:flex;flex-wrap:wrap"><div style="display:flex;width:587.1075px;font-size:12.892499999999998px;letter-spacing:0.03em;text-transform:uppercase;line-height:1.5;margin-left:0"><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>Jun 03 2017</div></div><div style="width:293.55375px;padding:12.892499999999998px 12.892499999999998px 0px 12.892499999999998px"><div>Fiction</div></div></div><div style="position:relative;width:587.1075px;padding:12.892499999999998px 0px"><div style="font-size:25.784999999999997px;line-height:1.25;padding:0px 12.892499999999998px;margin-top:-6.446249999999999px"><div style="padding-left:0">Probabilistic Programmming Sci-Fi: BayesHead 5000</div></div><div style="padding-top:6.446249999999999px;position:relative"><div style="font-size:15.041249999999998px;line-height:1.5em;display:flex;flex-wrap:wrap;padding-left:0"><div style="padding:0px 12.892499999999998px;width:293.55375px"><div style="height:90.24749999999999px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:4;hyphens:auto;-webkit-box-orient:vertical"><span>by <!-- -->Liam Sweeney<!-- --> ◦ </span>
We believe in fiction as an important tool for imagining future relationships to technology. In our reports on new technologies we feature short science fiction stories that imagine the possible implications. The following story, written by Liam Sweeney (email), appeared in our...</div><div style="overflow:hidden;width:100%;text-overflow:ellipsis;white-space:nowrap"><span class="display-link"><span>View<!-- --> <span style="text-transform:lowercase">Fiction</span></span></span></div></div><div style="position:relative;width:293.55375px"><div style="width:calc(100% - 25.784999999999997px);height:calc(100% - 12.892499999999998px);margin-left:12.892499999999998px;margin-top:6.446249999999999px;background-image:url(/static/images/2017/06/mc.png);background-size:contain;background-position:center center;background-repeat:no-repeat"></div></div></div></div></div></div></a><div style="position:absolute;left:-1px;top:-1px;height:calc(158.7301587301587% + 2px);width:calc(158.7301587301587% + 2px);transform:scale(0.6300000000000001);transform-origin:left top;border:solid 2px black;pointer-events:none"></div></div></div></div></div><div style="padding-bottom:25.784999999999997px;padding-top:25.784999999999997px" class="jsx-1135431938 jsx-2959859206"><div style="font-size:34.379999999999995px;line-height:1.25;padding:0px 12.892499999999998px 0px 12.892499999999998px;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0" class="jsx-1135431938 jsx-2959859206">About</div><div style="padding:0px 12.892499999999998px;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0;font-size:17.189999999999998px;line-height:1.5" class="jsx-1135431938 jsx-2959859206">Cloudera Fast Forward Labs is an applied machine learning research group. We help organizations recognize and develop new product and business opportunities through emerging technologies.<!-- --> </div><div style="padding:0px 12.892499999999998px;margin-bottom:12.892499999999998px;width:587.1075px;margin-left:0;font-size:17.189999999999998px;line-height:1.5" class="jsx-1135431938 jsx-2959859206"><a href="https://www.cloudera.com/products/fast-forward-labs-research.html" class="jsx-1135431938 jsx-2959859206">Learn more about working with us.</a></div></div></div><div class="jsx-1135431938 jsx-2959859206"><div style="position:relative" class="jsx-1135431938 jsx-2959859206"><div style="position:absolute;left:0;width:100%;height:2px;transform:scaleY(0.60165);transform-origin:center center;background:black;top:-1px"></div><div style="padding:12.892499999999998px;display:flex;justify-content:space-between;flex-wrap:wrap;font-size:17.189999999999998px;line-height:1.5" class="jsx-1135431938 jsx-2959859206"><div class="jsx-1135431938 jsx-2959859206"><a href="/" class="jsx-1135431938 jsx-2959859206">Blog</a></div><div style="display:flex;flex-wrap:wrap" class="jsx-1135431938 jsx-2959859206"><div style="margin-right:12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><a href="https://www.cloudera.com/products/fast-forward-labs-research.html" class="jsx-1135431938 jsx-2959859206">Cloudera</a></div><div style="margin-right:12.892499999999998px" class="jsx-1135431938 jsx-2959859206"><a href="https://blog.fastforwardlabs.com/" class="jsx-1135431938 jsx-2959859206">AI Experiments</a></div><div class="jsx-1135431938 jsx-2959859206"><a href="https://twitter.com/fastforwardlabs" class="jsx-1135431938 jsx-2959859206">Twitter</a></div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/posts/2017-06-25-fingerprinting-documents-with-steganography","query":{},"buildId":"EnU~FBvqy_55fWO5RkIyH","nextExport":true}</script><script async="" id="__NEXT_PAGE__/posts/2017-06-25-fingerprinting-documents-with-steganography" src="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/posts/2017-06-25-fingerprinting-documents-with-steganography.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/EnU~FBvqy_55fWO5RkIyH/pages/_app.js"></script><script src="/_next/static/runtime/webpack-fdce77a122c11e06ae50.js" async=""></script><script src="/_next/static/chunks/commons.f77b50de979bfbbb280b.js" async=""></script><script src="/_next/static/runtime/main-5ab107747766f1b4e0bf.js" async=""></script></body></html>